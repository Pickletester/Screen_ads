<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=845, height=314, initial-scale=1.0">
    <title>Novastar Live Feed</title>
    <style>
        body { margin: 0; padding: 0; background-color: #000; overflow: hidden; }
        #container { width: 845px; height: 314px; position: relative; }
        
        /* Ensure media fills the exact pixel dimensions */
        img, video { 
            width: 100%; 
            height: 100%; 
            position: absolute; 
            top: 0; 
            left: 0; 
            display: none; 
            object-fit: fill; 
        }
        .active { display: block; }
    </style>
</head>
<body>

    <div id="container">
        </div>

    <script>
        // ==========================================
        //        YOUR LIVE FEED PLAYLIST
        // ==========================================
        // To add ads, copy a line and change the filename.
        // filenames must match GitHub exactly (Case Sensitive!)
        
        var liveFeed = [
            { type: 'image', url: 'Applebox.jpg', duration: 10 },
            { type: 'image', url: 'Comcast.jpg', duration: 10 },
            { type: 'image', url: 'Feet_DR.jpg', duration: 10 }, 
            { type: 'image', url: 'Howard_Hannah.jpg', duration: 10 },
            { type: 'image', url: 'Itaily.jpg', duration: 10 },
            { type: 'image', url: 'J_Frances2.jpg', duration: 10 },
            { type: 'image', url: 'Lorenzi.jpg', duration: 10 },
            { type: 'image', url: 'Mission.jpg', duration: 10 },
            { type: 'image', url: 'Pickleball_lifeline.jpg', duration: 10 },
            { type: 'image', url: 'Sun_Chevy.jpg', duration: 10 },
            { type: 'image', url: 'ad1.jpg', duration: 10 },
            
            // ⚠️ SET THIS DURATION TO THE EXACT LENGTH OF YOUR VIDEO (Seconds)
            { type: 'video', url: 'Screen_2_1.mp4', duration: 15 } 
        ];

        // ==========================================
        //        ENGINE CODE (DO NOT TOUCH)
        // ==========================================
        var container = document.getElementById('container');
        var currentIndex = 0;

        function getSyncedStartIndex() {
            var totalLoopTime = 0;
            liveFeed.forEach(item => { totalLoopTime += item.duration; });

            // Get current Unix time in seconds
            var now = Math.floor(Date.now() / 1000);
            
            // Find our position in the global loop
            var timeIntoLoop = now % totalLoopTime;
            
            var accumulatedTime = 0;
            for (var i = 0; i < liveFeed.length; i++) {
                var itemDuration = liveFeed[i].duration;
                if (timeIntoLoop < accumulatedTime + itemDuration) {
                    return { 
                        index: i, 
                        remaining: (accumulatedTime + itemDuration) - timeIntoLoop 
                    };
                }
                accumulatedTime += itemDuration;
            }
            return { index: 0, remaining: liveFeed[0].duration };
        }

        function playNext(firstRun = false, overrideDuration = null) {
            // Loop back to start if needed
            if (currentIndex >= liveFeed.length) currentIndex = 0;

            var item = liveFeed[currentIndex];
            var durationToPlay = overrideDuration || item.duration;

            // Clear previous content
            container.innerHTML = '';

            if (item.type === 'image') {
                var img = document.createElement('img');
                img.src = item.url;
                img.className = 'active';
                container.appendChild(img);

                setTimeout(function() {
                    currentIndex++;
                    playNext();
                }, durationToPlay * 1000);
            } 
            else if (item.type === 'video') {
                var vid = document.createElement('video');
                vid.src = item.url;
                vid.className = 'active';
                vid.muted = true; // Required for auto-play
                vid.autoplay = true;
                vid.playsInline = true;
                
                // If syncing mid-video, jump to the correct second
                if (firstRun && overrideDuration) {
                   var startAt = item.duration - overrideDuration;
                   vid.currentTime = startAt;
                }

                // When video ends, go next
                vid.onended = function() {
                    currentIndex++;
                    playNext();
                };
                
                // Safety: If video breaks, skip it instantly
                vid.onerror = function() {
                    console.log("Video failed to load: " + item.url);
                    currentIndex++;
                    playNext();
                };
                
                container.appendChild(vid);
            }
        }

        // START THE LIVE FEED
        var startData = getSyncedStartIndex();
        currentIndex = startData.index;
        console.log("Live Feed Started. Jumped to Item Index: " + currentIndex);
        playNext(true, startData.remaining);

    </script>
</body>
</html>
